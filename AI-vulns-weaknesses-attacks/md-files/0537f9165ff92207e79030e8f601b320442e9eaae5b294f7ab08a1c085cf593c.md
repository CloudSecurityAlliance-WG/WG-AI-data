Imperceptible, Robust, and Targeted
Adversarial Examples for Automatic Speech Recognition
Yao Qin1Nicholas Carlini2Ian Goodfellow2Garrison Cottrell1Colin Raffel2
Abstract
Adversarial examples are inputs to machine learn-
ing models designed by an adversary to cause
an incorrect output. So far, adversarial examples
have been studied most extensively in the image
domain. In this domain, adversarial examples
can be constructed by imperceptibly modifying
images to cause misclassiÔ¨Åcation, and are prac-
tical in the physical world. In contrast, current
targeted adversarial examples applied to speech
recognition systems have neither of these proper-
ties: humans can easily identify the adversarial
perturbations, and they are not effective when
played over-the-air. This paper makes advances
on both of these fronts. First, we develop effec-
tively imperceptible audio adversarial examples
(veriÔ¨Åed through a human study) by leveraging
the psychoacoustic principle of auditory mask-
ing, while retaining 100% targeted success rate
on arbitrary full-sentence targets. Next, we make
progress towards physical-world over-the-air au-
dio adversarial examples by constructing perturba-
tions which remain effective even after applying
realistic simulated environmental distortions.
1. Introduction
Adversarial examples (Szegedy et al., 2013) are inputs that
have been speciÔ¨Åcally designed by an adversary to cause a
machine learning algorithm to produce a misclassiÔ¨Åcation
(Biggio et al., 2013). Initial work on adversarial examples
focused mainly on the domain of image classiÔ¨Åcation. In
order to differentiate properties of adversarial examples on
neural networks in general from properties which hold true
only on images, it is important to study adversarial exam-
ples in different domains. Indeed, adversarial examples
1Department of CSE, University of California, San Diego,
USA2Google Brain, USA. Correspondence to: Yao Qin
, Colin Raffel .
Proceedings of the 36thInternational Conference on Machine
Learning , Long Beach, California, PMLR 97, 2019. Copyright
2019 by the author(s).are known to exist on domains ranging from reinforcement
learning (Huang et al., 2017) to reading comprehension (Jia
& Liang, 2017) to speech recognition (Carlini & Wagner,
2018). This paper focuses on the latter of these domains,
where (Carlini & Wagner, 2018) showed that any given
source audio sample can be perturbed slightly so that an au-
tomatic speech recognition (ASR) system would transcribe
the audio as any different target sentence.
To date, adversarial examples on ASR differ from adversar-
ial examples on images in two key ways. First, adversarial
examples on images are imperceptible to humans: it is pos-
sible to generate an adversarial example without changing
the 8-bit brightness representation (Szegedy et al., 2013).
Conversely, adversarial examples on ASR systems are often
perceptible. While the perturbation introduced is often small
in magnitude, upon listening it is obvious that the added
perturbation is present (Sch ¬®onherr et al., 2018). Second,
adversarial examples on images work in the physical world
(Kurakin et al., 2016) (e.g., even when taking a picture of
them). In contrast, adversarial examples on ASR systems
do not yet work in such an ‚Äúover-the-air‚Äù setting where they
are played by a speaker and recorded by a microphone.
In this paper1, we improve the construction of adversarial
examples on the ASR system and match the power of attacks
on images by developing adversarial examples which are
imperceptible, and make steps towards robust adversarial
examples.
In order to generate imperceptible adversarial examples,
we depart from the common `pdistance measure widely
used for adversarial example research. Instead, we make
use of the psychoacoustic principle of auditory masking,
and only add the adversarial perturbation to regions of the
audio where it will not be heard by a human, even if this
perturbation is not ‚Äúquiet‚Äù in terms of absolute energy.
Further investigating properties of adversarial examples
which appear to be different from images, we examine the
ability of an adversary to construct physical-world adver-
sarial examples (Kurakin et al., 2016). These are inputs
that, even after taking into account the distortions intro-
1The project webpage is at http://cseweb.ucsd.edu/
Àúyaq007/imperceptible-robust-adv.htmlarXiv:1903.10346v2 [eess.AS] 7 Jun 2019Imperceptible, Robust, and Targeted Adversarial Examples for Automatic Speech Recognition
duced by the physical world, remain adversarial upon clas-
siÔ¨Åcation. We make initial steps towards developing audio
which can be played over-the-air by designing audio which
remains adversarial after being processed by random room-
environment simulators (Scheibler et al., 2018).
Finally, we additionally demonstrate that our attack is ca-
pable of attacking a modern, state-of-the-art Lingvo ASR
system (Shen et al., 2019).
2. Related Work
We build on a long line of work studying the robustness
of neural networks. This research area largely began with
(Biggio et al., 2013; Szegedy et al., 2013), who Ô¨Årst studied
adversarial examples for deep neural networks.
This paper focuses on adversarial examples on automatic
speech recognition systems. Early work in this space (Gong
& Poellabauer, 2017; Cisse et al., 2017) was successful
when generating untargeted adversarial examples that pro-
duced incorrect, but arbitrary, transcriptions. A concurrent
line of work succeeded at generating targeted attacks in
practice, even when played over a speaker and recorded by
a microphone (a so-called ‚Äúover-the-air‚Äù attack) but only by
both (a) synthesizing completely new audio and (b) target-
ing older, traditional (i.e., not neural network based) speech
recognition systems (Carlini et al., 2016; Zhang et al., 2017;
Song & Mittal, 2017).
These two lines of work were partially uniÔ¨Åed by Carlini &
Wagner (2018) who constructed adversarial perturbations
for speech recognition systems targeting arbitrary (multi-
word) sentences. However, this attack was neither effective
over-the-air, nor was the adversarial perturbation completely
inaudible; while the perturbations it introduces are very
quiet, they can be heard by a human (see x7.2). Con-
currently, the CommanderSong (Yuan et al., 2018) attack
developed adversarial examples that are effective over-the-
air but at a cost of introducing a signiÔ¨Åcant perturbation to
the original audio.
Following this, concurrent work with ours develops attacks
on deep learning ASR systems that either work over-the-air
or are less obviously perceptible.
Yakura & Sakuma (2018), create adversarial examples
which can be played over-the-air. These attacks are
highly effective on short two- or three-word phrases,
but not on the full-sentence phrases originally stud-
ied. Further, these adversarial examples often have a
signiÔ¨Åcantly larger perturbation, and in one case, the
perturbation introduced had a higher magnitude than
the original audio.
Sch¬®onherr et al. (2018) work towards developing at-
tacks that are less perceptible through using ‚ÄúPsychoa-coustic Hiding‚Äù and attack the Kaldi system, which is
partially based on neural networks but also uses some
‚Äútraditional‚Äù components such as a Hidden Markov
Model instead of an RNN for Ô¨Ånal classiÔ¨Åcation. Be-
cause of the system differences we can not directly
compare our results to that of this paper, but we encour-
age the reader to listen to examples from both papers.
Our concurrent work manages to achieve both of these re-
sults (almost) simultaneously: we generate adversarial ex-
amples that are both nearly imperceptible and also remain
effective after simulated distortions. Simultaneously, we
target a state-of-the-art network-based ASR system, Lingvo,
as opposed to Kaldi and generate full-sentence adversarial
examples as opposed to targeting short phrases.
A Ô¨Ånal line of work extends adversarial example genera-
tion on ASR systems from the white-box setting (where
the adversary has complete knowledge of the underlying
classiÔ¨Åer) to the black-box setting (Khare et al., 2018; Taori
et al., 2018) (where the adversary is only allowed to query
the system). This work is complementary and independent
of ours: we assume a white-box threat model.
3. Background
3.1. Problem DeÔ¨Ånition
Given an input audio waveform x, a target transcription
yand an automatic speech recognition (ASR) system f()
which outputs a Ô¨Ånal transcription, our objective is to con-
struct an imperceptible and targeted adversarial example
x0that can attack the ASR system when played over-the-
air. That is, we seek to Ô¨Ånd a small perturbation , which
enablesx0=x+to meet three requirements:
Targeted : the classiÔ¨Åer is fooled so that f(x0) =y
andf(x)6=y. Untargeted adversarial examples on
ASR systems often only introduce spelling errors and
so are less interesting to study.
Imperceptible :x0sounds so similar to xthat humans
cannot differentiate x0andxwhen listening to them.
Robust :x0is still effective when played by a speaker
and recorded by a microphone in an over-the-air attack.
(We do not achieve this goal completely, but do succeed
at simulated environments.)
3.1.1. ASR M ODEL
We mount our attacks on the Lingvo classiÔ¨Åer (Shen
et al., 2019), a state-of-the-art sequence-to-sequence model
(Sutskever et al., 2014) with attention (Bahdanau et al.,
2014) whose architecture is based on the Listen, Attend and
Spell model (Chan et al., 2016). It feeds Ô¨Ålter bank spectraImperceptible, Robust, and Targeted Adversarial Examples for Automatic Speech Recognition
into an encoder consisting of a stack of convolutional and
LSTM layers, which conditions an LSTM decoder that out-
puts the transcription. The use of the sequence-to-sequence
framework allows the entire model to be trained end-to-end
with the standard cross-entropy loss function.
3.1.2. T HREAT MODEL
In this paper, as is done in most prior work, we consider
the white box threat model where the adversary has full
access to the model as well as its parameters. In particular,
the adversary is allowed to compute gradients through the
model in order to generate adversarial examples.
When we mount over-the-air attacks, we do not assume we
know the exact conÔ¨Ågurations of the room in which the
attack will be performed. Instead, we assume we know
thedistribution from which the room will be drawn, and
generate adversarial examples so as to be effective on any
room drawn from this distribution.
3.2. Adversarial Example Generation
Adversarial examples are typically generated by performing
gradient descent with respect to the input on a loss func-
tion designed to be minimized when the input is adversarial
(Szegedy et al., 2013). SpeciÔ¨Åcally, let xbe an input to a neu-
ral network f(), letbe a perturbation, and let `(f(x);y)
be a loss function that is minimized when f(x) =y. Most
work on adversarial examples focuses on minimizing the
max-norm (kk1norm) of. Then, the typical adversarial
example generation algorithm (Szegedy et al., 2013; Carlini
& Wagner, 2017; Madry et al., 2017) solves
minimize`(f(x+);y) +kk
such thatkk<
(where in some formulations = 0). Here,controls the
maximum perturbation introduced.
To generate adversarial examples on ASR systems, Carlini &
Wagner (2018) set `to the CTC-loss and use the max-norm
which has the effect of adding a small amount of adversarial
perturbation consistently throughout the audio sample.
4. Imperceptible Adversarial Examples
Unlike on images, where minimizing `pdistortion between
an image and the nearest misclassiÔ¨Åed example yields a
visually indistinguishable image, on audio, this is not the
case (Sch ¬®onherr et al., 2018). Thus, in this work, we depart
from the`pdistortion measures and instead rely on the
extensive work which has been done in the audio space for
capturing the human perceptibility of audio.4.1. Psychoacoustic Models
A good understanding of the human auditory system is criti-
cal in order to be able to construct imperceptible adversarial
examples. In this paper, we use frequency masking , which
refers to the phenomenon that a louder signal (the ‚Äúmasker‚Äù)
can make other signals at nearby frequencies (the ‚Äúmas-
kees‚Äù) imperceptible (Mitchell, 2004; Lin & Abdulla, 2015).
In simple terms, the masker can be seen as creating a ‚Äúmask-
ing threshold‚Äù in the frequency domain. Any signals which
fall under this threshold are effectively imperceptible.
Because the masking threshold is measured in the frequency
domain, and because audio signals change rapidly over time,
we Ô¨Årst compute the short-time Fourier transform of the raw
audio signal to obtain the spectrum of overlapping sections
(called ‚Äúwindows‚Äù) of a signal. The window size Nis
2048 samples which are extracted with a ‚Äúhop size‚Äù of 512
samples and are windowed with the modiÔ¨Åed Hann window.
We denotesx(k)as thekth bin of the spectrum of frame x.
Then, we compute the log-magnitude power spectral density
(PSD) as follows:
px(k) = 10 log101
Nsx(k)2
: (1)
The normalized PSD estimate px(k)is deÔ¨Åned by Lin &
Abdulla (2015)
px(k) = 96 max
kfpx(k)g+px(k) (2)
Masking Threshold Given an audio input, in order to
compute its masking threshold, Ô¨Årst we need to identify
the maskers, whose normalized PSD estimate px(k)must
satisfy three criteria: 1) they must be local maxima in the
spectrum; 2) they must be higher than the threshold in quiet;
and 3) they have the largest amplitude within 0.5 Bark (a
psychoacoustically-motivated frequency scale) around the
masker‚Äôs frequency. Then, each masker‚Äôs masking threshold
can be approximated using the simple two-slope spread
function, which is derived to mimic the excitation patterns
of maskers. Finally, the global masking threshold x(k)is
a combination of the individual masking threshold as well
as the threshold in quiet via addition (because the effect
of masking is additive in the logarithmic domain). We
refer interested readers to our appendix and (Lin & Abdulla,
2015) for speciÔ¨Åcs on computing the masking threshold.
When we add the perturbation to the audio input x, if
the normalized PSD estimate of the perturbation p(k)is
under the frequency masking threshold of the original audio
x(k), the perturbation will be masked out by the raw audio
and therefore be inaudible to humans. The normalized PSD
estimate of the perturbation p(k)can be calculated via:
p(k) = 96 max
kfpx(k)g+p(k): (3)Imperceptible, Robust, and Targeted Adversarial Examples for Automatic Speech Recognition
wherep(k) = 10 log10j1
Ns(k)j2andpx(k) =
10 log10j1
Nsx(k)j2are the PSD estimate of the perturba-
tion and the original audio input.
4.2. Optimization with Masking Threshold
Loss function Given an audio example xand a target
phrasey, we formulate the problem of constructing an im-
perceptible adversarial example x0=x+as minimizing
the loss function `(x;;y ), which is deÔ¨Åned as:
`(x;;y ) =`net(f(x+);y) +`(x;) (4)
where`netrequires that the adversarial examples fool the
audio recognition system into making a targeted prediction
y, wheref(x)6=y. In the Lingvo model, the simple cross
entropy loss function is used for `net. The term`constrains
the normalized PSD estimation of the perturbation p(k)to
be under the frequency masking threshold of the original
audiox(k). The hinge loss is used here to compute the loss
for masking threshold:
`(x;) =1
bN
2c+ 1bN
2cX
k=0max
p(k) x(k);0 
;(5)
whereNis the predeÔ¨Åned window size and bxcoutputs the
greatest integer no larger than x. The adaptive parameter 
is to balance the relative importance of these two criteria.
4.2.1. T WOSTAGE ATTACK
Empirically, we Ô¨Ånd it is difÔ¨Åcult to directly minimize the
masking threshold loss function via backpropagation with-
out any constraint on the magnitude of the perturbation .
This is reasonable because it is very challenging to fool the
neural network and in the meanwhile, limit a very large
perturbation to be under the masking threshold in the fre-
quency domain. In contrast, if the perturbation is relatively
small in magnitude, then it will be much easier to push the
remaining distortion under the frequency masking threshold.
Therefore, we divide the optimization into two stages: the
Ô¨Årst stage of optimization focuses on Ô¨Ånding a relatively
small perturbation to fool the network (as was done in prior
work (Carlini & Wagner, 2018)) and the second stage makes
the adversarial examples imperceptible.
In the Ô¨Årst stage, we set in Eqn 4 to be zero and clip
the perturbation to be within a relatively small range. As a
result, the Ô¨Årst stage solves:
minimize`net(f(x+);y)
such thatkk<(6)
wherekkrepresents thekk1max-norm of . SpeciÔ¨Åcally,
we begin by setting = 0and then on each iteration:
 clip( lr1sign(r`net(f(x+);y)));(7)wherelr1is the learning rate and r`netis the gradient of
`netwith respect to . We initially set to a large value and
then gradually reduce it during optimization following Car-
lini & Wagner (2018).
The second stage focuses on making the adversarial exam-
ples imperceptible, with an unbounded max-norm; in this
stage,is only constrained by the masking threshold con-
straints. SpeciÔ¨Åcally, initialize with
imoptimized in the
Ô¨Årst stage and then on each iteration:
  lr2r`(x;;y ); (8)
wherelr2is the learning rate and r`is the gradient of
`with respect to . The loss function `(x;;y )is deÔ¨Åned
in Eqn. 4. The parameter that balances the network loss
`net(f(x+);y)and the imperceptibility loss `(x;y)is
initialized with a small value, e.g., 0.05, and is adaptively
updated according to the performance of the attack. SpeciÔ¨Å-
cally, every twenty iterations, if the current adversarial ex-
ample successfully fools the ASR system (i.e. f(x+) =y),
thenis increased to attempt to make the adversarial exam-
ple less perceptible. Correspondingly, every Ô¨Åfty iterations,
if the current adversarial example fails to make the targeted
prediction, we decrease . We check for attack failure less
frequently than success (Ô¨Åfty vs. twenty iterations) to allow
more iterations for the network to converge. The details
of the optimization algorithm are further explained in the
appendix.
5. Robust Adversarial Examples
5.1. Acoustic Room Simulator
In order to improve the robustness of adversarial examples
when playing over-the-air, we use an acoustic room simula-
tor to create artiÔ¨Åcial utterances (speech with reverberations)
that mimic playing the audio over-the-air. The transforma-
tion function in the acoustic room simulator, denoted as t,
takes the clean audio xas an input and outputs the simulated
speech with reverberation t(x). First, the room simulator ap-
plies the classic Image Source Method introduced in (Allen
& Berkley, 1979; Scheibler et al., 2018) to create the room
impulse response rbased on the room conÔ¨Ågurations (the
room dimension, source audio and target microphone‚Äôs lo-
cation, and reverberation time). Then, the generated room
impulse response ris convolved with the clean audio to
create the speech with reverberation, to obtain t(x) =xr
wheredenotes the convolution operation. To make the gen-
erated adversarial examples robust to various environments,
multiple room impulse responses rare used. Therefore, the
transformation function tfollows a chosen distribution T
over different room conÔ¨Ågurations.
5.2. Optimization with Reverberations
In this section, our objective is to make the perturbed speech
with reverberation (rather than the clean audio) fool the ASRImperceptible, Robust, and Targeted Adversarial Examples for Automatic Speech Recognition
system. As a result, the generated adversarial examples x0=
x+will be passed through the room simulator Ô¨Årst to create
the simulated speech with reverberation t(x0), mimicking
playing the adversarial examples over-the-air, and then the
simulatedt(x0)will be fed as the new input to fool the
ASR system, aiming at f(t(x0)) =y. Simultaneously, the
adversarial perturbation should be relatively small in order
not to be audible to humans.
In the same manner as the Expectation over Transformation
in (Athalye et al., 2018), we optimize the expectation of
the loss function over different transformations tT as
follows:
minimize`(x;;y ) =E
tT
`net(f(t(x+));y)
such thatkk<:(9)
Rather than directly targeting f(x+) =y, we apply
the loss function lnet(the cross entropy loss in the Lingvo
network) to the classiÔ¨Åcation of the transformed speech
f(t(x+)) =y. We approximate the gradient of the
expected value via independently sampling a transformation
tfrom the distribution Tat each gradient descent step.
In the Ô¨ÅrstIr1iterations, we initialize with a sufÔ¨Åciently
large value and gradually reduce it following Carlini & Wag-
ner (2018). We consider the adversarial example successful
if it successfully fools the ASR system under a single ran-
dom room conÔ¨Åguration; that is, if f(t(x+)) =yfor just
onet(). Once this optimization is complete, we obtain the
max-norm bound for , denoted as 
r. We will then use the
perturbation 
ras an initialization for in the next stage.
Then in the following Ir2iterations, we Ô¨Ånetune the pertur-
bationwith a much smaller learning rate. The max-norm
boundis increased to 
r=
r+, where >0, and held
constant during optimization. During this phase, we only
consider the attack successful if the adversarial example
successfully fools a set of randomly chosen transformations

 =ft1;t2;;tMg, wheretiT andMis the size of
the set 
. The transformation set 
is randomly sampled
from the distribution Tat each gradient descent step. In
other words, the adversarial example x0=x+gener-
ated in this stage satisÔ¨Åes 8ti2
,f(ti(x+)) =y. In
this way, we can generate robust adversarial examples that
successfully attack ASR systems when the exact room envi-
ronment is not known ahead of time, whose conÔ¨Åguration is
drawn from a pre-deÔ¨Åned distribution. More details of the
algorithm are shown in the appendix.
It should be emphasized that there is a tradeoff between
imperceptibility and robustness (as we will show experimen-
tally in Section 7.2). If we increase the maximal amplitude
of the perturbation 
r, the robustness can always be further
improved. Correspondingly, it becomes much easier for
humans to perceive the adversarial perturbation and alert theASR system. In order to keep these adversarial examples
mostly imperceptible, we therefore limit the `1amplitude
of the perturbation to be in a reasonable range.
6. Imperceptible and Robust Attacks
By combining both of the techniques we developed earlier,
we now develop an approach to generate both imperceptible
and robust adversarial examples. This can be achieved by
minimizing the loss
`(x;;y ) =E
tT
`net(f(t(x+));y)+`(x;)
;(10)
where the cross entropy loss function `net()is again the
loss used for Lingvo, and the imperceptibility loss `()is
the same as that deÔ¨Åned in Eqn 5. Since we need to fool the
ASR system when the speech is played under a random room
conÔ¨Åguration, the cross entropy loss `net(f(t(x+));y)
forces the transcription of the transformed adversarial ex-
amplet(x+)to bey(again, as done earlier).
To further improve these adversarial examples to be imper-
ceptible, we optimize `(x;)to constrain the perturbation
to fall under the masking threshold of the clean audio in
the frequency domain. This is much easier compared to
optimizing the hinge loss `(t(x);t()) = maxfpt()(k) 
t(x)(k);0gbecause the frequency masking threshold of the
clean audiox(k)can be pre-computed while the masking
threshold of the speech with reverberation t(x)(k)varies
with the room reverberation r. In addition, optimizing
`(x;)and`(t(x);t())have similar effects based on
the convolution theorem that the Fourier transform of a con-
volution of two signals is the pointwise product of their
Fourier transforms. Note that the speech with reverberation
t(x)is a convolution of the clean audio xand a simulated
room reverberation r, hence:
Fft(x)g=Ffxrg=FfxgFfrg (11)
whereFis the Fourier transform, denotes the convolution
operation andrepresents the pointwise product. We apply
the short-time Fourier transform to the perturbation and
the raw audio signal Ô¨Årst in order to compute the power
spectral density pt()and the masking threshold t(x)in the
frequency domain. Since most of the energy in the room
impulse response falls within the spectral analysis window
size, the convolution theorem in Eqn 11 is approximately
satisÔ¨Åed. Therefore, we arrive at:
(pt() t(x))(p x)Ffrg: (12)
As a result, simply optimizing the imperceptibility loss
`(x;)can help in Ô¨Ånding the optimal and in constructing
the imperceptible adversarial examples that can attack the
ASR systems in the physical world.Imperceptible, Robust, and Targeted Adversarial Examples for Automatic Speech Recognition
SpeciÔ¨Åcally, we will Ô¨Årst initialize with the perturbation

rthat enables the adversarial examples to be robust in
Section 5. Then in each iteration, we randomly sample
a transformation tfrom the distribution Tand update 
according to:
  lr3r
`net(f(t(x+);y))+`(x;))
;(13)
wherelr3is the learning rate and , a parameter that bal-
ances the importance of the robustness and the impercepti-
bility, is adaptively changed based on the performance of
adversarial examples. SpeciÔ¨Åcally, if the constructed ad-
versarial example can successfully attack a set of randomly
chosen transformations, then will be increased to focus
more on imperceptibility loss. Otherwise, is decreased to
make the attack more robust to multiple room environments.
The implementation details are illustrated in the appendix.
7. Evaluation
7.1. Datasets and Evaluation Metrics
Datasets We use the LibriSpeech dataset (Panayotov et al.,
2015) in our experiments, which is a corpus of 16KHz En-
glish speech derived from audiobooks and is used to train
the Lingvo system (Shen et al., 2019). We randomly select
1000 audio examples as source examples, and 1000 separate
transcriptions from the test-clean dataset to be the targeted
transcriptions. We ensure that each target transcription is
around the same length as the original transcription because
it is unrealistic and overly challenging to perturb a short
audio clip ( e.g., 10 words) to have a much longer transcrip-
tion ( e.g., 20 words). Examples of the original and targeted
transcriptions are available in the appendix.
Evaluation Metrics For automatic speech recognition,
we evaluate our model using the standard word error rate
(WER) metric, which is deÔ¨Åned as WER =S+D+I
NW100% ,
whereS,DandIare the number of substitutions, deletions
and insertions of words respectively, and NWis the total
number of words in the reference.
We also calculate the success rate (sentence-level accuracy)
asAccuracy =Ns
Na100% , whereNais the number of
audio examples that we test, and Nsis the number of audio
examples that are correctly transcribed. Here, ‚Äúcorrectly
transcribed‚Äù means the original transcription for clean audio
and the targeted transcription for adversarial examples.
7.2. Imperceptibility Analysis
To attack the Lingvo ASR system, we construct 1000 imper-
ceptible and targeted adversarial examples, one for each of
the examples we sampled from the LibriSpeech test-clean
dataset. Table1 shows the performance of the clean audio
and the constructed adversarial examples. We can see that
the word error rate (WER) of the clean audio is just 4:47%
19%66%23%82%66%83%85%24%76%
(a)(b)(c)CleanBaselineOursCleanvsBaselineCleanvsOursOursvsBaselineCleanvsCleanCleanvsBaselineCleanvsOursPercentageofNoisyExamples(%)
PercentageofAischosenasmorenatural(AvsB)(%)
Percentageofidenticalexamples(%)Figure 1. Results of human study for imperceptibility. Here base-
line represents the adversarial example generated by Carlini &
Wagner (2018), and ours denotes the imperceptible adversarial
example generated following the algorithm in Section. 4.
on the 1000 test examples, indicating the model is of high
quality. Our imperceptible adversarial examples perform
even better, and reach a 100 %success rate.
7.2.1. Q UALITATIVE HUMAN STUDY
Of the 1000 examples selected from the test set, we ran-
domly selected 100of these with their corresponding imper-
ceptible adversarial examples. We then generate an adversar-
ial example using the prior work of Carlini & Wagner (2018)
for the same target phrase; this attack again succeeds with
100% success. We perform three experiments to validate
that our adversarial examples are imperceptible, especially
compared to prior work.
Experimental Design. We recruit 80users online from
Amazon Mechanical Turk. We give each user one of the
three (nearly identical) experiments, each of which we de-
scribe below. In all cases, the experiments consist of 20
‚Äúcomparisons tasks‚Äù, where we present the evaluator with
some audio samples and ask them questions (described be-
low) about the samples. We ask the users to listen to each
sample with headphones on, and answer a simple question
about the audio samples (the question is determined by
which experiment we run, as given below). We do not ex-
plain the purpose of the study other than that it is a research
study, and do not record any personally identifying informa-
tion.2We randomly include a small number of questions
with known, obvious answers; we remove 3 users from the
study who failed to answer these questions correctly.
In all experiments, users have the ability to listen to audio
Ô¨Åles multiple times when they are unsure of the answer,
making it as difÔ¨Åcult as possible for our adversarial exam-
ples to pass as clean data. Users additionally have the added
beneÔ¨Åt of hearing 20examples back-to-back, effectively
‚Äútraining‚Äù them to recognize subtle differences. Indeed, a
permutation test Ô¨Ånds users are statistically signiÔ¨Åcantly bet-
ter at distinguishing adversarial examples from clean audio
during the second half of the experiment compared to the
2Unfortunately, for this reason, we are unable to report aggre-
gate statistics such as age or gender, slightly harming potential
reproducibility.Imperceptible, Robust, and Targeted Adversarial Examples for Automatic Speech Recognition
Input Clean Adversarial
Accuracy (%) 58.60 100.00
WER (%) 4.47 0.00
Table 1. Sentence-level accuracy and WER for
1000 clean and (imperceptible) adversarially per-
turbed examples, fed without over-the-air sim-
ulation into the Lingvo model. In ‚ÄúClean‚Äù,
the ground truth is the original transcription.
In‚ÄúAdversarial‚Äù, the ground truth is the targeted
transcription.Input CleanRobust
( = 300 )Robust
( = 400 )Imperceptible
& Robust
Accuracy (%) 31.37 62.96 64.64 49.65
WER (%) 15.42 14.45 13.83 22.98
Table 2. Sentence-level accuracy and WER for 100 clean and adversarially perturbed
examples, fed with over-the-air simulation into the Lingvo model. The ground truth
for ‚Äúclean‚Äù inputs is the original transcription while the ground truth is the targeted
transcription for the adversarial inputs. The perturbation is bounded by kk<
r+.
Ô¨Årst half of the experiment, although the magnitude of the
difference is small: only by about 3%. Figure 1 summarizes
the statistical results we give below.
Experiment 1: clean or noisy. We begin with what we
believe is the most representative experiment of how an
attack would work in practice. We give users one audio
sample and ask them to tell us if it has anybackground noise
(e.g., static, echoing, people talking in the background).
As a baseline, users believed that 19% of original clean
audio samples contained some amount of noise, and 66%
of users believed that the adversarial examples generated
by Carlini & Wagner (2018) contained some amount of
noise. In comparison, only 23% of users believe that the
adversarial examples we generate contain any noise, a result
that is not statistically signiÔ¨Åcantly different from clean
audio (p>: 05). That is, when presented with just one audio
sample in isolation, users do not believe the adversarial
examples we generate are any noisier than the clean samples.
Experiment 2: identify the original. We give users two
audio samples and inform them that one of the audio sam-
ples is a modiÔ¨Åed version of the other; we ask the user to
select the audio sample corresponding to the one which
sounds like the more natural audio sample. This setup is
much more challenging: when users can listen to both the
before and after, it is often possible to pick up on the small
amount of distortion that has been added. When comparing
the original audio to the adversarial examples generated by
Carlini & Wagner (2018), the evaluator chose the original
audio 82% of the time. When we have the evaluator com-
pare the imperceptible adversarial examples we generate
to those of Carlini & Wagner (2018), our imperceptible ex-
amples are selected as the better audio samples 83% of the
time‚Äîa difference that is not statistically distinguishable
from comparing against the clean audio.
However, when directly comparing the adversarial examples
we generate to the clean audio, users prefer the clean audio
still66% of the time. Observe that the baseline percentage,
when the samples are completely indistinguishable, is 50%.Thus, users only perform 16% better than random guessing
at distinguishing our examples from clean examples.
Experiment 3: identical or not. Finally, we perform the
most difÔ¨Åcult experiment: we present users with two audio
Ô¨Åles, and ask them if the audio samples are identical, or if
there are anydifferences. As the baseline, when given the
same audio sample twice, users agreed it was identical 85%
of the time. (That is, in 15% of cases the evaluator wrongly
heard a difference between the two samples.) When given a
clean audio sample and comparing it to the audio generated
by Carlini & Wagner (2018), users only believed them to
be identical 24% of the time. Comparing clean audio to
the adversarial examples we generate, user believed them
to be completely identical 76% of the time, 3more often
than the adversarial examples generated by the baseline, but
below the 85%-identical value for actually-identical audio.
7.3. Robustness Analysis
To mount our simulated over-the-air attacks, we consider
a challenging setting that the exact conÔ¨Åguration of the
room in which the attack will be performed is unknown.
Instead, we are only aware of the distribution from which the
room conÔ¨Åguration will be drawn. First, we generate 1000
random room conÔ¨Ågurations sampled from the distribution
as the training room set. The test room set includes another
100 random room conÔ¨Ågurations sampled from the same
distribution. Adversarial examples are created to attack
the Lingvo ASR system when played in the simulated test
rooms. We randomly choose 100 audio examples from
LibriSpeech dataset to perform this robustness test.
As shown in Table 2, when fed non-adversarial audio played
in simulated test rooms, the WER of the Lingvo ASR de-
grades to 15:42% which suggests some robustness to re-
verberation. In contrast, the success rate of adversarial
examples in (Carlini & Wagner, 2018) and our impercepti-
ble adversarial examples in Section 4 are 0%in this setting.
The success rate of our robust adversarial examples gener-
ated based on the algorithm in Section 5 is over 60%, and
the WER is smaller than that of the clean audio. Both theImperceptible, Robust, and Targeted Adversarial Examples for Automatic Speech Recognition
success rate and the WER demonstrate that our constructed
adversarial examples remain effective when played in the
highly-realistic simulated environment.
In addition, the robustness of the constructed adversarial
examples can be improved further at the cost of increased
perceptibility. As presented in Table 2, when we increase
the max-norm bound of the amplitude of the adversarial
perturbation 
r=
r+ (is increased from 300 to 400),
both the success rate and WER are improved correspond-
ingly. Since our Ô¨Ånal objective is to generate imperceptible
and robust adversarial examples that can be played over-the-
air in the physical world, we limit the max-norm bound of
the perturbation to be in a relatively small range to avoid a
huge distortion toward the clean audio.
To construct imperceptible as well as robust adversarial
examples, we start from the robust attack (  = 300 ) and
Ô¨Ånetune it with the imperceptibility loss. In our experiments,
we observe that 81 %of the robust adversarial examples3
can be further improved to be much less perceptible while
still retaining high robustness (around 50 %success rate and
22:98% WER).
7.3.1. Q UALITATIVE HUMAN STUDY
We run identical experiments (as described earlier) on the
robust and robust-and-imperceptible adversarial examples.
Inexperiment 1 , where we ask evaluators if there is any
noise, only 6%heard any noise on the clean audio, com-
pared to 100% on the robust (but perceptible) adversarial
examples and 83% on the robust and imperceptible adver-
sarial examples.4
Inexperiment 2 , where we ask evaluators to identify the
original audio, comparing clean to robust adversarial exam-
ples the evaluator correctly identiÔ¨Åed the original audio 97%
of the time versus 89% when comparing the clean audio to
the imperceptible and robust adversarial examples.
Finally, in experiment 3 , where we ask evaluators if the au-
dio is identical, the baseline clean audio was judged different
95% of the time when compared to the robust adversarial
examples, and the clean audio was judged different 71% of
the time when compared to the imperceptible and robust
adversarial examples.
In all cases, the imperceptible and robust adversarial ex-
amples are statistically signiÔ¨Åcantly less perceptible than
just the robust adversarial examples, but also statistically
3The other 19 %adversarial examples lose the robustness be-
cause they cannot successfully attack the ASR system in 8 ran-
domly chosen training rooms in any iteration during optimization.
4Evaluators stated they heard noise on clean examples 3less
often compared to the baseline in the prior study. We believe this
is due to the fact that when primed with examples which are obvi-
ously different, the baseline becomes more easily distinguishable.signiÔ¨Åcantly more perceptible than the clean audio. Di-
rectly comparing the imperceptible and robust adversarial
examples to the robust examples, evaluators believed the
imperceptible examples had less distortion 91% of the time.
Clearly the adversarial examples that are robust are signiÔ¨Å-
cantly easier to distinguish from clean audio, even when we
apply the masking threshold. However, this result is consis-
tent with work on adversarial examples on images, where
completely imperceptible physical-world adversarial exam-
ples have not been successfully constructed. On images,
physical attacks require over 16as much distortion to be
effective on the physical world (see, for example, Figure 4
of Kurakin et al. (2016)).
8. Conclusion
In this paper, we successfully construct imperceptible adver-
sarial examples (veriÔ¨Åed by a human study) for automatic
speech recognition based on the psychoacoustic principle
of auditory masking, while retaining 100 %targeted success
rate on arbitrary full-sentence targets. Simultaneously, we
also make progress towards developing robust adversarial
examples that remain effective after being played over-the-
air (processed by random room environment simulators),
increasing the practicality of actual real-world attacks using
adversarial examples targeting ASR systems.
We believe that future work is still required: our robust
adversarial examples do not play fully over-the-air, despite
working in simulated room environments. Resolving this
difÔ¨Åculty while maintaining a high targeted success rate is
necessary for demonstrating a practical security concern.
As a Ô¨Ånal contribution of potentially independent interest,
this work demonstrates how one might go about constructing
adversarial examples for non- `p-based metrics. Especially
on images, nearly all adversarial example research has fo-
cused on this highly-limited distance measure. Devoting
efforts to identifying different methods that humans use to
assess similarity, and generating adversarial examples ex-
ploiting those metrics, is an important research effort we
hope future work will explore.
Acknowledgements
The authors would like to thank Patrick Nguyen, Jonathan
Shen and Rohit Prabhavalkar for helpful discussions on
Lingvo ASR system and Arun Narayanan for suggestions
in room impulse simulations. We also want to thank the
reviewers for their useful comments. This work was greatly
supported by Google Brain. GWC and YQ were also par-
tially supported by Guangzhou Science and Technology
Planning Project (Grant No. 201704030051).Imperceptible, Robust, and Targeted Adversarial Examples for Automatic Speech Recognition
References
Allen, J. B. and Berkley, D. A. Image method for efÔ¨Åciently
simulating small-room acoustics. The Journal of the
Acoustical Society of America , 65(4):943‚Äì950, 1979.
Athalye, A., Engstrom, L., Ilyas, A., and Kwok, K. Synthe-
sizing robust adversarial examples. In ICML , 2018.
Bahdanau, D., Cho, K., and Bengio, Y . Neural machine
translation by jointly learning to align and translate. arXiv
preprint arXiv:1409.0473 , 2014.
Biggio, B., Corona, I., Maiorca, D., Nelson, B., ÀáSrndi ¬¥c, N.,
Laskov, P., Giacinto, G., and Roli, F. Evasion attacks
against machine learning at test time. In Joint European
conference on machine learning and knowledge discovery
in databases , pp. 387‚Äì402. Springer, 2013.
Carlini, N. and Wagner, D. Towards evaluating the robust-
ness of neural networks. In 2017 IEEE Symposium on
Security and Privacy (SP) , pp. 39‚Äì57. IEEE, 2017.
Carlini, N. and Wagner, D. A. Audio adversarial examples:
Targeted attacks on speech-to-text. 2018 IEEE Security
and Privacy Workshops (SPW) , pp. 1‚Äì7, 2018.
Carlini, N., Mishra, P., Vaidya, T., Zhang, Y ., Sherr, M.,
Shields, C., Wagner, D., and Zhou, W. Hidden voice
commands. In USENIX Security Symposium , pp. 513‚Äì
530, 2016.
Chan, W., Jaitly, N., Le, Q., and Vinyals, O. Listen, attend
and spell: A neural network for large vocabulary conver-
sational speech recognition. In Acoustics, Speech and
Signal Processing (ICASSP), 2016 IEEE International
Conference on , pp. 4960‚Äì4964. IEEE, 2016.
Cisse, M., Adi, Y ., Neverova, N., and Keshet, J. Houdini:
Fooling deep structured prediction models. arXiv preprint
arXiv:1707.05373 , 2017.
Gong, Y . and Poellabauer, C. Crafting adversarial examples
for speech paralinguistics applications. arXiv preprint
arXiv:1711.03280 , 2017.
Huang, S., Papernot, N., Goodfellow, I., Duan, Y ., and
Abbeel, P. Adversarial attacks on neural network policies.
arXiv preprint arXiv:1702.02284 , 2017.
Jia, R. and Liang, P. Adversarial examples for evalu-
ating reading comprehension systems. arXiv preprint
arXiv:1707.07328 , 2017.
Khare, S., Aralikatte, R., and Mani, S. Adversarial black-
box attacks for automatic speech recognition systems
using multi-objective genetic optimization. arXiv preprint
arXiv:1811.01312 , 2018.Kingma, D. P. and Ba, J. Adam: A method for stochastic
optimization. arXiv preprint arXiv:1412.6980 , 2014.
Kurakin, A., Goodfellow, I., and Bengio, S. Adversar-
ial examples in the physical world. arXiv preprint
arXiv:1607.02533 , 2016.
Lin, Y . and Abdulla, W. H. Principles of psychoacoustics.
InAudio Watermark , pp. 15‚Äì49. Springer, 2015.
Madry, A., Makelov, A., Schmidt, L., Tsipras, D., and
Vladu, A. Towards deep learning models resistant to
adversarial attacks. arXiv preprint arXiv:1706.06083 ,
2017.
Mitchell, J. L. Introduction to digital audio coding and
standards. Journal of Electronic Imaging , 13(2):399,
2004.
Panayotov, V ., Chen, G., Povey, D., and Khudanpur, S.
Librispeech: an asr corpus based on public domain au-
dio books. In Acoustics, Speech and Signal Processing
(ICASSP), 2015 IEEE International Conference on , pp.
5206‚Äì5210. IEEE, 2015.
Scheibler, R., Bezzam, E., and Dokmani ¬¥c, I. Pyroomacous-
tics: A python package for audio room simulation and
array processing algorithms. In 2018 IEEE International
Conference on Acoustics, Speech and Signal Processing
(ICASSP) , pp. 351‚Äì355. IEEE, 2018.
Sch¬®onherr, L., Kohls, K., Zeiler, S., Holz, T., and Kolossa,
D. Adversarial attacks against automatic speech recogni-
tion systems via psychoacoustic hiding. arXiv preprint
arXiv:1808.05665 , 2018.
Shen, J., Nguyen, P., Wu, Y ., Chen, Z., Chen, M. X., Jia,
Y ., Kannan, A., Sainath, T., Cao, Y ., Chiu, C.-C., et al.
Lingvo: a modular and scalable framework for sequence-
to-sequence modeling. arXiv preprint arXiv:1902.08295 ,
2019.
Song, L. and Mittal, P. Inaudible voice commands. arXiv
preprint arXiv:1708.07238 , 2017.
Sutskever, I., Vinyals, O., and Le, Q. V . Sequence to se-
quence learning with neural networks. In Advances in
Neural Information Processing Systems , pp. 3104‚Äì3112,
2014.
Szegedy, C., Zaremba, W., Sutskever, I., Bruna, J., Erhan,
D., Goodfellow, I., and Fergus, R. Intriguing properties of
neural networks. arXiv preprint arXiv:1312.6199 , 2013.
Taori, R., Kamsetty, A., Chu, B., and Vemuri, N. Targeted
adversarial examples for black box audio systems. arXiv
preprint arXiv:1805.07820 , 2018.Imperceptible, Robust, and Targeted Adversarial Examples for Automatic Speech Recognition
Yakura, H. and Sakuma, J. Robust audio adversar-
ial example for a physical attack. arXiv preprint
arXiv:1810.11793 , 2018.
Yuan, X., Chen, Y ., Zhao, Y ., Long, Y ., Liu, X., Chen,
K., Zhang, S., Huang, H., Wang, X., and Gunter,
C. A. Commandersong: A systematic approach for
practical adversarial voice recognition. arXiv preprint
arXiv:1801.08535 , 2018.
Zhang, G., Yan, C., Ji, X., Zhang, T., Zhang, T., and Xu, W.
Dolphinattack: Inaudible voice commands. In Proceed-
ings of the 2017 ACM SIGSAC Conference on Computer
and Communications Security , pp. 103‚Äì117. ACM, 2017.
Appendix
A. Frequency Masking Threshold
In this section, we detail how we compute the frequency
masking threshold for constructing imperceptible adversar-
ial examples. This procedure is based on psychoacoustic
principles which were reÔ¨Åned over many years of human
studies. For further background on psychoacoustic mod-
els, we refer the interested reader to (Lin & Abdulla, 2015;
Mitchell, 2004).
Step 1: IdentiÔ¨Åcations of Maskers
In order to compute the frequency masking threshold of an
input signal x(n), where 0nN, we need to Ô¨Årst iden-
tify the maskers. There are two different classes of maskers:
tonal and nontonal maskers, where nontonal maskers have
stronger masking effects compared to tonal maskers. Here
we simply treat all the maskers as tonal ones to make sure
the threshold that we compute can always mask out the
noise. The normalized PSD estimate of the tonal maskers
pm
x(k)must meet three criteria. First, they must be local
maxima in the spectrum, satisfying:
px(k 1)pm
x(k)and pm
x(k)px(k+ 1);(14)
where 0kmax(kk)then
 max(kk)
end if
 0:8
end if
end for
# Stage 2: minimize the perceptibility
Reassign= 0:05
fori= 0toT2 1do
  lr2r`(x;;y )
ifi% 20 = 0 andf(x+) =ythen
 1:2
end if
ifi% 50 = 0 andf(x+)6=ythen
 0:8
end if
end for
Output: adversarial example x0=x+
will be reduced to be 0.1 after 3000 iterations. The adaptive
parameterwhich balances the importance between `net
and`begins with 0:05and gradually updated based on the
performance of adversarial examples. Algorithm 1 shows
the details of the two-stage optimization.
D.2. Robust Adversarial Examples
To develop the robust adversarial examples that could work
after played over-the-air, we also optimize the adversarial
perturbation in two stages. The Ô¨Årst stage intends to Ô¨Ånd a
relative small perturbation while the second stage focuses
on making the constructed adversarial example more robust
to random room conÔ¨Ågurations. The learning rate lr1in the
Ô¨Årst stage is 50andwill be updated for 2000 iterations.
The max-norm bound for the adversarial perturbation 
starts from 2000 as well and will be gradually reduced. In
the second stage, the number of iterations is set to be 4000
and the learning rate lr2is5. In this stage, is Ô¨Åxed and
equals the optimized 
rin the Ô¨Årst stage plus . The size
of transformation set 
is set to beM= 10 .Imperceptible, Robust, and Targeted Adversarial Examples for Automatic Speech Recognition
x The clean audio input
 The adversarial perturbation added to clean audio
x0The constructed adversarial example
y The targeted transcription
f() The attacked neural network (ASR)
F() Fourier transform
k The index of the spectrum
N The window size in short term Fourier transform
sx(k) Thek-th bin of the spectrum for audio x
s(k) Thek-th bin of the spectrum for perturbation 
px(k) The log-magnitude power spectral density (PSD) for audio xat indexk
px(k) The normalized PSD estimated for audio xat indexk
p(k) The log-magnitude power spectral density (PSD) for audio at indexk
p(k) The normalized PSD estimated for audio at indexk
x(k) The frequency masking threshold for audio xat indexk
`(x;;y ) Loss function to optimize to construct adversarial examples
`net(;y) Loss function to fool the neural network with the input ()and outputy
`(x;) Imperceptibility loss function
 A hyperparameter to balance the importance of `netand`
kk Max-norm
 Max-norm bound of perturbation 
r() The gradient of () with regard to 
lr1;lr2;lr3The learning rate in gradient descent
r Room reverberation
t() The room transformation related to the room conÔ¨Åguration
T The distribtion from which the transformation t()is sampled from

im The optimized in the Ô¨Årst stage in constructing imperceptible adversarial examples

r The optimized in the Ô¨Årst stage in constructing robust adversarial examples

r The optimized in the Ô¨Årst stage in constructing robust adversarial examples

r The max-norm bound for used in the second stage in constructing robust adversarial examples

r The optimized in the second stage in constructing robust adversarial examples
 The difference between 
r 
r

 A set of transformations sampled from distribution T
M The size of the transformation set 
Table 3. Notations and DeÔ¨Ånitions used in our algorithms.
Original phrase 1 the more she is engaged in her proper duties the less leisure will she have for it even as an
accomplishment and a recreation
Targeted phrase 1 old will is a Ô¨Åne fellow but poor and helpless since missus rogers had her accident
Original phrase 2 a little cracked that in the popular phrase was my impression of the stranger who now made his
appearance in the supper room
Targeted phrase 2 her regard shifted to the green stalks and leaves again and she started to move away
Table 4. Examples of the original and targeted phrases on the LibriSpeech dataset.Imperceptible, Robust, and Targeted Adversarial Examples for Automatic Speech Recognition
D.3. Imperceptible and Robust Attacks
To construct imperceptible as well as robust adversarial
examples, we begin with the robust adversarial examples
generated in Section. D.2. In the Ô¨Årst stage, we focus on
reducing the imperceptibility by setting the initial to be
0.01 and the learning rate is set to be 1. We update the adver-
sarial perturbation for 4000 iterations. If the adversarial
example successfully attacks the ASR system in 4 out of
10 randomly chosen rooms, then with be increased by 2.
Otherwise, for every 50 iterations, will be decreased by
0.5.
In the second stage, we focus on improving the less percep-
tible adversarial examples to be more robust. The learning
rate is 1.5 and starts from a very small value 0:00005 . The
perturbation will be further updated for 6000 iterations. If
the adversarial example successfully attacks the ASR sys-
tem in 8 out of 10 randomly chosen rooms, then will be
increased by 1.2.
E. Transcription Examples
Some examples of the original phrases and targeted tran-
scriptions from the LibriSpeech dataset (Panayotov et al.,
2015) are shown in Table 4.