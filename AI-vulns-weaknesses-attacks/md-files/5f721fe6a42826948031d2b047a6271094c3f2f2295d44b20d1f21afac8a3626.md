3/7/24, 2:56 PM CWE - CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) (4.14)
https://cwe.mitre.org/data/deﬁnitions/338.html 1/3
Common W eakness Enumeration
A community-developed list of SW & HW weaknesses that can become
vulnerabilities
Home Search
CWE-338: Use of Cryptographically W eak Pseudo-Random Number Generator
(PRNG)
Weakness ID: 338
Vulnerability Mapping: 
View customized information:
 Description
The product uses a Pseudo-Random Number Generator (PRNG) in a security context, but the PRNG's algorithm is not
cryptographically strong.
 Extended Description
When a non-cryptographic PRNG is used in a cryptographic context, it can expose the cryptography to certain types of attacks.
Often a pseudo-random number generator (PRNG) is not designed for cryptography . Sometimes a mediocre source of randomness is
sufficient or preferable for algorithms that use random numbers. W eak generators generally take less processing power and/or do not
use the precious, finite, entropy sources on a system. While such PRNGs might have very useful features, these same features could
be used to break the cryptography .
 Relationships
 Relevant to the view "Research Concepts" (CWE-1000)
Nature Type ID Name
ChildOf 330 Use of Insuf ficiently Random V alues
 Relevant to the view "Software Development" (CWE-699)
Nature Type ID Name
MemberOf 1213 Random Number Issues
MemberOf 310 Cryptographic Issues
 Relevant to the view "W eaknesses for Simplified Mapping of Published V ulnerabilities" (CWE-1003)
 Relevant to the view "Architectural Concepts" (CWE-1008)
 Modes Of Introduction
Phase Note
Architecture and Design
Implementation REALIZA TION: This weakness is caused during implementation of an architectural security tactic.
 Applicable Platforms
Languages
Class: Not Language-Specific (Undetermined Prevalence)
 Common Consequences
Scope Impact Likelihood
Access ControlTechnical Impact: Bypass Protection Mechanism
If a PRNG is used for authentication and authorization, such as a session ID or a seed for
generating a cryptographic key , then an attacker may be able to easily guess the ID or
cryptographic key and gain access to restricted functionality .
 Likelihood Of Exploit
Medium
 Demonstrative Examples
Example 1
Both of these examples use a statistical PRNG seeded with the current value of the system clock to generate a random number:About ▼ CWE List ▼ Mapping ▼ Top-N Lists ▼ Community ▼ News ▼
ALLOWED
Abstraction: Base
Conceptual OperationalMapping
FriendlyComplete Custom
(bad code) Example Language: Java 
Random random = new Random(System.currentTimeMillis());
it tID d tIt()3/7/24, 2:56 PM CWE - CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) (4.14)
https://cwe.mitre.org/data/deﬁnitions/338.html 2/3The random number functions used in these examples, rand() and Random.nextInt(), are not considered cryptographically strong. An
attacker may be able to predict the random numbers generated by these functions. Note that these example also exhibit CWE-337
(Predictable Seed in PRNG).
 Observed Examples
Reference Description
CVE-2021-3692 PHP framework uses mt\_rand() function (Marsenne Twister) when generating tokens
CVE-2009-3278 Crypto product uses rand() library function to generate a recovery key , making it easier to conduct
brute force attacks.
CVE-2009-3238 Random number generator can repeatedly generate the same value.
CVE-2009-2367 Web application generates predictable session IDs, allowing session hijacking.
CVE-2008-0166 SSL library uses a weak random number generator that only generates 65,536 unique keys.
 Potential Mitigations
Phase: Implementation
Use functions or hardware which use a hardware-based random number generation for all crypto. This is the recommended
solution. Use CyptGenRandom on Windows, or hw\_rand() on Linux.
 Detection Methods
Automated Static Analysis
Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically , this is done by building a
model of data flow and control flow , then searching for potentially-vulnerable patterns that connect "sources" (origins of input)
with "sinks" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)
Effectiveness: High
 Memberships
Nature Type ID Name
MemberOf 884 CWE Cross-section
MemberOf 905 SFP Primary Cluster: Predictability
MemberOf 1170 SEI CER T C Coding Standard - Guidelines 48. Miscellaneous (MSC)
MemberOf 1346 OWASP Top Ten 2021 Category A02:2021 - Cryptographic Failures
MemberOf 1414 Comprehensive Categorization: Randomness
 Vulnerability Mapping Notes
Usage: ALLOWED (this CWE ID could be used to map to real-world vulnerabilities)
Reason: Acceptable-Use
Rationale:
This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of
vulnerabilities.
Comments:
Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a
lower-level Base/V ariant simply to comply with this preferred level of abstraction.
 Notes
Maintenance
As of CWE 4.5, terminology related to randomness, entropy , and predictability can vary widely . Within the developer and other
communities, "randomness" is used heavily . However , within cryptography , "entropy" is distinct, typically implied as a measurement.
There are no commonly-used definitions, even within standards documents and cryptography papers. Future versions of CWE will
attempt to define these terms and, if necessary , distinguish between them in ways that are appropriate for dif ferent communities but
do not reduce the usability of CWE for mapping, understanding, or other scenarios.
 Taxonomy Mappings
Mapped T axonomy Name Node ID Fit Mapped Node Name
CLASP Non-cryptographic PRNG
CER T C Secure Coding MSC30-C CWE More
AbstractDo not use the rand() function for generating pseudorandom
numbers
int accountID = random.nextInt();
(bad code) Example Language: C 
srand(time());
int randNum = rand();3/7/24, 2:56 PM CWE - CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) (4.14)
https://cwe.mitre.org/data/deﬁnitions/338.html 3/3
 References
[REF-18] Secure Software, Inc.. "The CLASP Application Security Process". 2005.
.
[REF-44] Michael Howard, David LeBlanc and John V iega. "24 Deadly Sins of Software Security". "Sin 20: W eak Random
Numbers." Page 299. McGraw-Hill. 2010.
 Content History
 Submissions
Submission Date Submitter Organization
2006-07-19
(CWE Draft 3, 2006-07-19)CLASP
 Modifications
 Previous Entry Names